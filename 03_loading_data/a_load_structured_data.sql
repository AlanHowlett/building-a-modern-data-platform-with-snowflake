-- ####################################################################################################################
-- Use the SYSADMIN role
-- ####################################################################################################################
use role sysadmin;


-- ####################################################################################################################
-- Use the load warehouse we previously created
-- ####################################################################################################################
use warehouse loader;


-- ####################################################################################################################
-- Load data from this repository into the stages that were just created
-- ####################################################################################################################
put file:///ABSOLUTE_PATH_TO/building-a-modern-data-platform-with-snowflake/data/titanic.csv.gz @raw.titanic.load_stg/ auto_compress = true source_compression = none;


-- ####################################################################################################################
-- Examine LOAD_STG to check the staged file
-- ####################################################################################################################
ls @raw.titanic.load_stg/;


-- ####################################################################################################################
-- Copy data from the raw.snowplow.load_stg internal stage into the raw.snowplow.events table.
-- ####################################################################################################################
copy into raw.titanic.passengers from @raw.titanic.load_stg/titanic.csv.gz file_format = (type = csv field_delimiter = ',' skip_header = 1 field_optionally_enclosed_by='"');
